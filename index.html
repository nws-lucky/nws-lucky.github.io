<!DOCTYPE html>
<html lang="">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <link rel="icon" href="favicon.ico">
  <title>Newwave's Lucky Number Machine</title>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet" href="./styles/style.css" type="text/css" media="screen" />
  <link rel="stylesheet" href="./styles/animations.css" type="text/css" media="screen" />
  <link rel="stylesheet" href="./dist/jquery.slotmachine.css" type="text/css" media="screen" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css"
    type="text/css" />

  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>
  <script src="./dist/slotmachine.js"></script>
  <script src="./dist/jquery.slotmachine.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/javascript.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.0.10/js/all.js"
    integrity="sha384-slN8GvtUJGnv6ca26v8EzVaR9DC58QEwsIk9q1QXdCU8Yu8ck/tL/5szYlBbqmS+"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<div class="overlay" id="overlay">
</div>
<div class="popup" id="congratulation_popup">
  <div class="popup__content">
    <div class="popup__header">
      <span class="popup__tile">Xin chúc mừng</span>
    </div>
    <div class="lucky__people">
      <div class="lucky__people-info">
        <p class="popup__lucky--fullname" id="luckyPeopleFullname"></p>
        <span class="popup__lucky--short-name" id="luckyPeopleShortname"></span>
      </div>
      <div id="submit-form-delete" class="pop__up-button">
        <button type='submit' class="pop__up-button-ok" id="order-cancel-btn-ok" onclick="closePopUp()">Đóng</button>
    </div>
    </div>
  </div>
</div>

<body>
  <!-- congrats animation: id = class = js-container -->
  <div class="container-animation js-container" id="js-container" style="top:0px !important; z-index: 1000;"></div>

  <div style="text-align:center;position:  fixed;width:100%;height:100%;top:0px;left:0px;">
    <div id="casino">
      <div class="content">
        <div class="slotNumber">
          <div id="casino1" class="slotMachine">
            <div class="slot slot1"></div>
            <div class="slot slot2"></div>
            <div class="slot slot3"></div>
            <div class="slot slot4"></div>
            <div class="slot slot5"></div>
            <div class="slot slot6"></div>
            <div class="slot slot7"></div>
            <div class="slot slot8"></div>
            <div class="slot slot9"></div>
            <div class="slot slot10"></div>
          </div>
  
          <div id="casino2" class="slotMachine">
            <div class="slot slot1"></div>
            <div class="slot slot2"></div>
            <div class="slot slot3"></div>
            <div class="slot slot4"></div>
            <div class="slot slot5"></div>
            <div class="slot slot6"></div>
            <div class="slot slot7"></div>
            <div class="slot slot8"></div>
            <div class="slot slot9"></div>
            <div class="slot slot10"></div>
          </div>
  
          <div id="casino3" class="slotMachine">
            <div class="slot slot1"></div>
            <div class="slot slot2"></div>
            <div class="slot slot3"></div>
            <div class="slot slot4"></div>
            <div class="slot slot5"></div>
            <div class="slot slot6"></div>
            <div class="slot slot7"></div>
            <div class="slot slot8"></div>
            <div class="slot slot9"></div>
            <div class="slot slot10"></div>
          </div>
  
          <div class="btn-group btn-group-justified" role="group">
            <button id="casinoShuffle" type="button" class="btn btn-primary btn-lg btn-1">START</button>
            <button id="casinoStop" type="button" class="btn btn-primary btn-lg btn-2">STOP</button>
          </div>
        </div>
      </div>
  
      <div class="container-fluid">
        <div class="row">
  
        </div>
      </div>
    </div>
    
  </div>  
  

  <script id="codeScript5">
    let count = 0;
    const btnShuffle = document.querySelector('#casinoShuffle');
    const btnStop = document.querySelector('#casinoStop');
    const casino1 = document.querySelector('#casino1');
    const casino2 = document.querySelector('#casino2');
    const casino3 = document.querySelector('#casino3');
    const mCasino1 = new SlotMachine(casino1, {
      active: 0,
      delay: 500
    });
    const mCasino2 = new SlotMachine(casino2, {
      active: 0,
      delay: 500
    });
    const mCasino3 = new SlotMachine(casino3, {
      active: 0,
      delay: 500
    });
  </script>
  <script id="codeScript6">
    function showPopUp(fullname, shortname) {
      document.getElementById("overlay").style.display = "block";
      document.getElementById("congratulation_popup").style.display = "block";
      document.getElementById("luckyPeopleFullname").innerHTML = fullname;
      document.getElementById("luckyPeopleShortname").innerHTML = shortname;
      document.getElementById("js-container").classList.add("js-container");
      document.getElementById("js-container").style.display = "block";
      window.confettiful = new Confettiful(document.querySelector('.js-container'));
    }
    function closePopUp() {
      document.getElementById("overlay").style.display = "none";
      document.getElementById("congratulation_popup").style.display = "none";
      document.getElementById("js-container").style.display = "none";
    }
    let data;
    let firstNumber = 0;
    let secondNumber = 0;
    let thirdNumber = 0;
    let maxNum = 248;
    if (window.location.hash && !isNaN(window.location.hash.substring(1))) {
      maxNum = Number(window.location.hash.substring(1));
    }
    /**
     * Using solution in here https://stackoverflow.com/questions/1527803/generating-random-whole-numbers-in-javascript-in-a-specific-range 
     */
    function randomNumber(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }
    /**
     * Leading zeros format
     */
    function pad(num, size) {
      var s = "000000000" + num;
      return s.substr(s.length - size);
    }
    /**
     * Handle event click start lucky number machine
     */
    btnShuffle.addEventListener('click',async (e) => {
      e.preventDefault();
      count = 3;
      firstNumber = 0;
      secondNumber = 0;
      thirdNumber = 0;

      mCasino1.shuffle(9999);
      mCasino2.shuffle(9999);
      mCasino3.shuffle(9999);

      data = await axios({
        method: 'get',
        url: 'http://192.168.200.121:3000/api/employee/lucky',
      })  
        .then((reponse) => {
          return reponse.data;
        })
        .catch((e) => console.log(e))
      let randomNum = data.id;

      let result = pad(randomNum, 3);
      console.log(`Random number is: ${randomNum}`);
      let resultArr = result.split("").map((num) => {
        return Number(num);
      })

      firstNumber = resultArr[0];
      secondNumber = resultArr[1];
      thirdNumber = resultArr[2];
    });

    /**
     * Handle event when click stop button 
     * get random number on first click
     */
    btnStop.addEventListener('click', () => {
      switch (count) {
        case 3:
          mCasino1.randomize = () => {
            console.log(`First lucky number is: ${firstNumber}`);
            return firstNumber;
          }
          mCasino1.stop();
          break;
        case 2:
          mCasino2.randomize = () => {
            console.log(`Second lucky number is: ${secondNumber}`);
            return secondNumber;
          }
          mCasino2.stop();
          break;
        case 1:
          mCasino3.randomize = () => {
            console.log(`Third lucky number is: ${thirdNumber}`);
            return thirdNumber;
          }
          mCasino3.stop();
          console.log(`Final Number: ${firstNumber}${secondNumber}${thirdNumber}`);
          setTimeout(()=>{
            showPopUp(data.fullname, data.shortname);
          }, 1000)
          break;
      }
      count--;
    });
  </script>

  <script id="codeScript7">
    const Confettiful = function(el) {
      this.el = el;
      this.containerEl = null;
      
      this.confettiFrequency = 3;
      this.confettiColors = ['#EF2964', '#00C09D', '#2D87B0', '#48485E','#EFFF1D'];
      this.confettiAnimations = ['slow', 'medium', 'fast'];
      
      this._setupElements();
      this._renderConfetti();
    };

    Confettiful.prototype._setupElements = function() {
      const containerEl = document.createElement('div');
      const elPosition = this.el.style.position;
      
      if (elPosition !== 'relative' || elPosition !== 'absolute') {
        this.el.style.position = 'relative';
      }
      
      containerEl.classList.add('confetti-container');
      
      this.el.appendChild(containerEl);
      
      this.containerEl = containerEl;
      console.log(containerEl)

    };

    Confettiful.prototype._renderConfetti = function() {
      this.confettiInterval = setInterval(() => {
        const confettiEl = document.createElement('div');
        const confettiSize = (Math.floor(Math.random() * 3) + 7) + 'px';
        const confettiBackground = this.confettiColors[Math.floor(Math.random() * this.confettiColors.length)];
        const confettiLeft = (Math.floor(Math.random() * this.el.offsetWidth)) + 'px';
        const confettiAnimation = this.confettiAnimations[Math.floor(Math.random() * this.confettiAnimations.length)];
        
        confettiEl.classList.add('confetti', 'confetti--animation-' + confettiAnimation);
        confettiEl.style.left = confettiLeft;
        confettiEl.style.width = confettiSize;
        confettiEl.style.height = confettiSize;
        confettiEl.style.backgroundColor = confettiBackground;
        
        confettiEl.removeTimeout = setTimeout(function() {
          confettiEl.parentNode.removeChild(confettiEl);
        }, 5000);
        
        this.containerEl.appendChild(confettiEl);
      }, 2);
    };
  </script>
</body>

</html>